<link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/pivottable/pivot.css">
<script type="text/javascript" src="<?php echo base_url(); ?>assets/table2CSV/table2CSV.js" crossorigin="anonymous"></script>


<button onclick="exportTableToExcel('printTable')">Exportar a Excel</button>

<!-- <table class="pvtTable" id="printTable" border="1" data-numrows="13" data-numcols="7"><thead><tr><th colspan="2" rowspan="1"></th><th class="pvtAxisLabel">lote</th><th class="pvtColLabel" colspan="1" rowspan="2">0</th><th class="pvtColLabel" colspan="1" rowspan="2">1</th><th class="pvtColLabel" colspan="1" rowspan="2">2</th><th class="pvtColLabel" colspan="1" rowspan="2">3</th><th class="pvtColLabel" colspan="1" rowspan="2">4</th><th class="pvtColLabel" colspan="1" rowspan="2">AREA CAMPAMENTO	</th><th class="pvtColLabel" colspan="1" rowspan="2">AREA SOCIAL	</th><th class="pvtTotalLabel pvtRowTotalLabel" rowspan="2">Totals</th></tr><tr><th class="pvtAxisLabel">semana</th><th class="pvtAxisLabel">subtarea</th><th></th></tr></thead><tbody><tr><th class="pvtRowLabel" rowspan="13">15</th><th class="pvtRowLabel" rowspan="1" colspan="2">ALIMENTACION DE PERSONAL</th><td class="pvtVal row0 col0" data-value="1">1</td><td class="pvtVal row0 col1" data-value="4">4</td><td class="pvtVal row0 col2" data-value="1">1</td><td class="pvtVal row0 col3" data-value="null"></td><td class="pvtVal row0 col4" data-value="null"></td><td class="pvtVal row0 col5" data-value="null"></td><td class="pvtVal row0 col6" data-value="1">1</td><td class="pvtTotal rowTotal" data-value="7" data-for="row0">7</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">APLICACION CON MOTOBOMBA</th><td class="pvtVal row1 col0" data-value="1">1</td><td class="pvtVal row1 col1" data-value="2">2</td><td class="pvtVal row1 col2" data-value="null"></td><td class="pvtVal row1 col3" data-value="null"></td><td class="pvtVal row1 col4" data-value="null"></td><td class="pvtVal row1 col5" data-value="null"></td><td class="pvtVal row1 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="3" data-for="row1">3</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">APLICACION DE HERBICIDA PESADA</th><td class="pvtVal row2 col0" data-value="null"></td><td class="pvtVal row2 col1" data-value="null"></td><td class="pvtVal row2 col2" data-value="null"></td><td class="pvtVal row2 col3" data-value="1">1</td><td class="pvtVal row2 col4" data-value="1">1</td><td class="pvtVal row2 col5" data-value="null"></td><td class="pvtVal row2 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="2" data-for="row2">2</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">APLICACIÓN DE FOLIARES</th><td class="pvtVal row3 col0" data-value="null"></td><td class="pvtVal row3 col1" data-value="null"></td><td class="pvtVal row3 col2" data-value="null"></td><td class="pvtVal row3 col3" data-value="null"></td><td class="pvtVal row3 col4" data-value="2">2</td><td class="pvtVal row3 col5" data-value="null"></td><td class="pvtVal row3 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="2" data-for="row3">2</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">CHOFER CAMION INO 300</th><td class="pvtVal row4 col0" data-value="null"></td><td class="pvtVal row4 col1" data-value="null"></td><td class="pvtVal row4 col2" data-value="null"></td><td class="pvtVal row4 col3" data-value="null"></td><td class="pvtVal row4 col4" data-value="null"></td><td class="pvtVal row4 col5" data-value="1">1</td><td class="pvtVal row4 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="1" data-for="row4">1</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">CORONA DE AVANCE</th><td class="pvtVal row5 col0" data-value="1">1</td><td class="pvtVal row5 col1" data-value="6">6</td><td class="pvtVal row5 col2" data-value="5">5</td><td class="pvtVal row5 col3" data-value="1">1</td><td class="pvtVal row5 col4" data-value="6">6</td><td class="pvtVal row5 col5" data-value="null"></td><td class="pvtVal row5 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="19" data-for="row5">19</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">COSECHA DE CACAO AVANCE LIBRAS TEMP ALTA</th><td class="pvtVal row6 col0" data-value="null"></td><td class="pvtVal row6 col1" data-value="null"></td><td class="pvtVal row6 col2" data-value="null"></td><td class="pvtVal row6 col3" data-value="null"></td><td class="pvtVal row6 col4" data-value="2">2</td><td class="pvtVal row6 col5" data-value="null"></td><td class="pvtVal row6 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="2" data-for="row6">2</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">ENCARGADO DE INVENTARIOS</th><td class="pvtVal row7 col0" data-value="null"></td><td class="pvtVal row7 col1" data-value="1">1</td><td class="pvtVal row7 col2" data-value="null"></td><td class="pvtVal row7 col3" data-value="1">1</td><td class="pvtVal row7 col4" data-value="null"></td><td class="pvtVal row7 col5" data-value="null"></td><td class="pvtVal row7 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="2" data-for="row7">2</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">MANTENIMIENTO AREAS SOCIALES</th><td class="pvtVal row8 col0" data-value="null"></td><td class="pvtVal row8 col1" data-value="1">1</td><td class="pvtVal row8 col2" data-value="null"></td><td class="pvtVal row8 col3" data-value="1">1</td><td class="pvtVal row8 col4" data-value="1">1</td><td class="pvtVal row8 col5" data-value="null"></td><td class="pvtVal row8 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="3" data-for="row8">3</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">RIEGO</th><td class="pvtVal row9 col0" data-value="1">1</td><td class="pvtVal row9 col1" data-value="2">2</td><td class="pvtVal row9 col2" data-value="null"></td><td class="pvtVal row9 col3" data-value="null"></td><td class="pvtVal row9 col4" data-value="null"></td><td class="pvtVal row9 col5" data-value="null"></td><td class="pvtVal row9 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="3" data-for="row9">3</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">ROZA GUADAÑA PESADA POR AVANCE</th><td class="pvtVal row10 col0" data-value="null"></td><td class="pvtVal row10 col1" data-value="null"></td><td class="pvtVal row10 col2" data-value="5">5</td><td class="pvtVal row10 col3" data-value="null"></td><td class="pvtVal row10 col4" data-value="null"></td><td class="pvtVal row10 col5" data-value="null"></td><td class="pvtVal row10 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="5" data-for="row10">5</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">ROZA GUADAÑA POR AVANCE SUAVE</th><td class="pvtVal row11 col0" data-value="1">1</td><td class="pvtVal row11 col1" data-value="6">6</td><td class="pvtVal row11 col2" data-value="6">6</td><td class="pvtVal row11 col3" data-value="null"></td><td class="pvtVal row11 col4" data-value="1">1</td><td class="pvtVal row11 col5" data-value="null"></td><td class="pvtVal row11 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="14" data-for="row11">14</td></tr><tr><th class="pvtRowLabel" rowspan="1" colspan="2">SEGURIDAD</th><td class="pvtVal row12 col0" data-value="null"></td><td class="pvtVal row12 col1" data-value="null"></td><td class="pvtVal row12 col2" data-value="3">3</td><td class="pvtVal row12 col3" data-value="null"></td><td class="pvtVal row12 col4" data-value="null"></td><td class="pvtVal row12 col5" data-value="null"></td><td class="pvtVal row12 col6" data-value="null"></td><td class="pvtTotal rowTotal" data-value="3" data-for="row12">3</td></tr><tr><th class="pvtTotalLabel pvtColTotalLabel" colspan="3">Totals</th><td class="pvtTotal colTotal" data-value="5" data-for="col0">5</td><td class="pvtTotal colTotal" data-value="22" data-for="col1">22</td><td class="pvtTotal colTotal" data-value="20" data-for="col2">20</td><td class="pvtTotal colTotal" data-value="4" data-for="col3">4</td><td class="pvtTotal colTotal" data-value="13" data-for="col4">13</td><td class="pvtTotal colTotal" data-value="1" data-for="col5">1</td><td class="pvtTotal colTotal" data-value="1" data-for="col6">1</td><td class="pvtGrandTotal" data-value="66">66</td></tr></tbody></table> -->

<?php echo $resultadoTabla ?>

<script>
    function exportTableToExcel(tableID, filename = ''){
        var downloadLink;
        var dataType = 'application/vnd.ms-excel';
        var tableSelect = document.getElementById(tableID);
        var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
        
        // Specify file name
        filename = filename?filename+'.xls':'reporte_am.xls';
        curtime = new Date().toISOString().
        replace(/T/, ' ').replace(/\..+/, '');
        filename = curtime + '__' + filename;
        
        // Create download link element
        downloadLink = document.createElement("a");
        
        document.body.appendChild(downloadLink);
        
        if(navigator.msSaveOrOpenBlob){
            var blob = new Blob(['\ufeff', tableHTML], {
                type: dataType
            });
            navigator.msSaveOrOpenBlob( blob, filename);
        }else{
            // Create a link to the file
            downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
        
            // Setting the file name
            downloadLink.download = filename;
            
            //triggering the function
            downloadLink.click();
        }
    }
    </script>


